I"»I<p>####Table Of Contents</p>

<ul>
  <li><strong>6.1 Adding A Delete Button</strong></li>
  <li><a href="/courses/twitter-clone/6/2">6.2 Removing The Tweet From The Database</a></li>
</ul>

<p><strong><em>Make sure you are logged into Vagrant before starting today‚Äôs lessons.</em></strong> <a href="/guides/logging-into-vagrant" target="_blank">Click here to view the ‚ÄúLogging Into Vagrant Guide‚Äù</a></p>

<p>Welcome to day 6 of the Twitter clone course.  Yesterday, we created a tweet edit page that let us update tweets.  Today, we are going to cover the ‚ÄúD‚Äù (Delete) in CRUD and learn how to delete tweets. Today‚Äôs lesson is shorter than the previous days because there isn‚Äôt much to deleting data.  Let‚Äôs get started.</p>

<p>Like editing tweets, right now, anyone that visits our site will be able to delete tweets.  Don‚Äôt worry about this too much since tomorrow we will go over how to use cookies to allow only the computer that created the tweet to update or delete it.</p>

<p>From the user‚Äôs perspective, the only thing we really need to add to our page is a delete button for each tweet.  We could add this button to each tweet on our homepage like we did with the ‚ÄúEdit‚Äù link, but putting it there makes it pretty easy to accidently delete a tweet.  Instead, let‚Äôs put our delete button on the edit tweet page so it‚Äôs a little harder to accidently delete a tweet.</p>

<p>We could make another POST route to delete tweets and have a new form that submits to that route, but a new form is probably overkill since a delete tweet form would only contain a button.  Instead, we can add our delete button to our update form.</p>

<p>When submitting a form, if you give the button that is submitting the form a ‚Äúname‚Äù attribute, you can check whether the button was clicked.  So for our form, we‚Äôll have an ‚ÄúUpdate Tweet‚Äù and a ‚ÄúDelete Tweet‚Äù button.  Both will submit the update form and we can check which of these buttons was pressed in the ‚Äú/tweets/:id/update‚Äù POST route. Based on which was pressed, we can either update or delete the tweet.  Let‚Äôs add a delete button to our form with a name attribute.</p>

<div class="language-ejs highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!-- views/edit-tweet.ejs --&gt;</span>
<span class="nt">&lt;form</span> <span class="na">id=</span><span class="s">"tweet-form"</span> <span class="na">action=</span><span class="s">"/tweets/&lt;%= tweet.id %&gt;/update"</span> <span class="na">method=</span><span class="s">"POST"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">"tweet-form-handle"</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"handle"</span> <span class="na">placeholder=</span><span class="s">"DonkkaShane"</span> <span class="na">value=</span><span class="s">"&lt;%= tweet.handle %&gt;"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;textarea</span> <span class="na">id=</span><span class="s">"tweet-form-body"</span> <span class="na">name=</span><span class="s">"body"</span> <span class="na">placeholder=</span><span class="s">"What's happening?"</span><span class="nt">&gt;</span><span class="k">&lt;%= </span><span class="nx">tweet</span><span class="p">.</span><span class="nx">body</span><span class="k"> %&gt;</span><span class="nt">&lt;/textarea&gt;</span>
  <span class="nt">&lt;button</span> <span class="na">id=</span><span class="s">"tweet-form-button"</span><span class="nt">&gt;</span>Update Tweet<span class="nt">&lt;/button&gt;</span>
  <span class="nt">&lt;button</span> <span class="na">id=</span><span class="s">"tweet-form-delete-button"</span> <span class="na">name=</span><span class="s">"delete_button"</span><span class="nt">&gt;</span>Delete Tweet<span class="nt">&lt;/button&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</code></pre></div></div>

<p>We are giving our ‚ÄúDelete Tweet‚Äù button a name attribute of ‚Äúdelete_button‚Äù.  We also gave it an id of ‚Äútweet-form-delete-button‚Äù so we can style it a little differently than our ‚ÄúUpdate Tweet‚Äù button.</p>

<p>Since we want users to use caution when pressing the delete button, we‚Äôll give ours the color red.  Red contrasts with the rest of the site and will make the user more cautious when pressing it.  The following is the style we are going to use for our button.  Add this to site.css.</p>

<div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">/* public/css/site.css */</span>
<span class="nf">#tweet-form-delete-button</span> <span class="p">{</span>
  <span class="nl">color</span><span class="p">:</span> <span class="m">#ffffff</span><span class="p">;</span>
  <span class="nl">font-size</span><span class="p">:</span> <span class="m">14px</span><span class="p">;</span>
  <span class="nl">padding</span><span class="p">:</span> <span class="m">7px</span> <span class="m">8px</span><span class="p">;</span>
  <span class="nl">background-color</span><span class="p">:</span> <span class="m">#e53334</span><span class="p">;</span>
  <span class="nl">border</span><span class="p">:</span> <span class="m">1px</span> <span class="nb">solid</span> <span class="nb">transparent</span><span class="p">;</span>
  <span class="nl">border-radius</span><span class="p">:</span> <span class="m">4px</span><span class="p">;</span>
  <span class="nl">cursor</span><span class="p">:</span> <span class="nb">pointer</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>If you refresh our edit tweet page, you should see the following.</p>

<p><img src="https://s3.amazonaws.com/spark-school/courses/twitter-clone/6/6-1-adding-delete-button.png" alt="" /></p>

<p>Now we have a delete button that will submit our form, but we don‚Äôt want users to accidentally click the delete button when they intend to update the tweet.  To prevent this, we can add a confirm dialog that asks the user if they are sure they want to delete.  Update our delete button to look like the following and I‚Äôll explain in a minute.</p>

<div class="language-ejs highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!-- views/edit-tweet.ejs --&gt;</span>
<span class="nt">&lt;button</span> <span class="na">id=</span><span class="s">"tweet-form-delete-button"</span> <span class="na">name=</span><span class="s">"delete_button"</span> <span class="na">onclick=</span><span class="s">"return confirm('Are you sure you want to delete the tweet?')"</span><span class="nt">&gt;</span>Delete Tweet<span class="nt">&lt;/button&gt;</span>
</code></pre></div></div>

<p>This line is a little long, but you‚Äôll notice I added an ‚Äúonclick‚Äù attribute to the button element. The ‚Äúonclick‚Äù attribute allows us to define some javascript that will be called when the button is clicked.  If true is returned in ‚Äúonclick‚Äù then the button submits.  If false is returned, the button does nothing.</p>

<p>In the ‚Äúonclick‚Äù javascript, we are returning the value returned by the ‚Äúconfirm‚Äù function.  This is a javascript function that takes a message and displays it to the user asking if it‚Äôs okay or not.  If the user presses ‚ÄúOK‚Äù then true is returned.  If the user presses ‚ÄúCancel‚Äù, false is returned.  This behavior works perfectly for the ‚Äúonclick‚Äù attribute, so we can just return the value from ‚Äúconfirm()‚Äù.</p>

<p>Now if you refresh the edit page and press delete, you will be asked if you want to delete a tweet.</p>

<p><img src="https://s3.amazonaws.com/spark-school/courses/twitter-clone/6/6-1-adding-confirm-dialog.png" alt="" /></p>

<p>Pressing ‚ÄúOK‚Äù will submit the form and pressing ‚ÄúCancel‚Äù will not.</p>

<p>We now have our delete button created, but submitting the form with our delete button will still update the tweet rather than delete it since we haven‚Äôt update our update route yet.  In the next section, we‚Äôll add a check for which button was pressed and update or delete the tweet accordingly.</p>

<h3 id="final-code">Final Code</h3>

<div class="language-ejs highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!-- views/edit-tweet.ejs --&gt;</span>
<span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
  <span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">type=</span><span class="s">"text/css"</span> <span class="na">href=</span><span class="s">"/css/site.css"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;/head&gt;</span>
  <span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;header&gt;&lt;/header&gt;</span>
    <span class="nt">&lt;main&gt;</span>
      <span class="k">&lt;%- </span><span class="nx">include</span><span class="p">(</span><span class="dl">'</span><span class="s1">_tweet</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span> <span class="na">tweet</span><span class="p">:</span> <span class="nx">tweet</span> <span class="p">});</span><span class="k"> %&gt;</span>
      <span class="nt">&lt;form</span> <span class="na">id=</span><span class="s">"tweet-form"</span> <span class="na">action=</span><span class="s">"/tweets/&lt;%= tweet.id %&gt;/update"</span> <span class="na">method=</span><span class="s">"POST"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">"tweet-form-handle"</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"handle"</span> <span class="na">placeholder=</span><span class="s">"DonkkaShane"</span> <span class="na">value=</span><span class="s">"&lt;%= tweet.handle %&gt;"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;textarea</span> <span class="na">id=</span><span class="s">"tweet-form-body"</span> <span class="na">name=</span><span class="s">"body"</span> <span class="na">placeholder=</span><span class="s">"What's happening?"</span><span class="nt">&gt;</span><span class="k">&lt;%= </span><span class="nx">tweet</span><span class="p">.</span><span class="nx">body</span><span class="k"> %&gt;</span><span class="nt">&lt;/textarea&gt;</span>
        <span class="nt">&lt;button</span> <span class="na">id=</span><span class="s">"tweet-form-button"</span><span class="nt">&gt;</span>Update Tweet<span class="nt">&lt;/button&gt;</span>
        <span class="nt">&lt;button</span> <span class="na">id=</span><span class="s">"tweet-form-delete-button"</span> <span class="na">name=</span><span class="s">"delete_button"</span> <span class="na">onclick=</span><span class="s">"return confirm('Are you sure you want to delete the tweet?')"</span><span class="nt">&gt;</span>Delete Tweet<span class="nt">&lt;/button&gt;</span>
      <span class="nt">&lt;/form&gt;</span>
    <span class="nt">&lt;/main&gt;</span>
  <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre></div></div>

<div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">/* public/css/site.css */</span>
<span class="nt">header</span> <span class="p">{</span>
  <span class="nl">position</span><span class="p">:</span> <span class="nb">fixed</span><span class="p">;</span>
  <span class="nl">top</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span>
  <span class="nl">left</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span>
  <span class="nl">right</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span>
  <span class="nl">background-color</span><span class="p">:</span> <span class="m">#ffffff</span><span class="p">;</span>
  <span class="nl">border-bottom</span><span class="p">:</span> <span class="m">1px</span> <span class="nb">solid</span> <span class="m">#d9d9d9</span><span class="p">;</span>
  <span class="nl">height</span><span class="p">:</span> <span class="m">50px</span><span class="p">;</span>
<span class="p">}</span>

<span class="nt">main</span> <span class="p">{</span>
  <span class="nl">width</span><span class="p">:</span> <span class="m">600px</span><span class="p">;</span>
  <span class="nl">margin</span><span class="p">:</span> <span class="m">60px</span> <span class="nb">auto</span> <span class="m">0px</span> <span class="nb">auto</span><span class="p">;</span>
  <span class="nl">background-color</span><span class="p">:</span> <span class="m">#ffffff</span><span class="p">;</span>
  <span class="nl">border</span><span class="p">:</span> <span class="m">1px</span> <span class="nb">solid</span> <span class="m">#e1e8ed</span><span class="p">;</span>
  <span class="nl">border-radius</span><span class="p">:</span> <span class="m">6px</span><span class="p">;</span>
<span class="p">}</span>

<span class="nt">body</span> <span class="p">{</span>
  <span class="nl">background-color</span><span class="p">:</span> <span class="m">#f5f8fa</span><span class="p">;</span>
  <span class="nl">font-family</span><span class="p">:</span> <span class="s1">"Helvetica Neue"</span><span class="p">,</span> <span class="n">Helvetica</span><span class="p">,</span> <span class="n">Arial</span><span class="p">,</span> <span class="nb">sans-serif</span><span class="p">;</span>
  <span class="nl">font-size</span><span class="p">:</span> <span class="m">14px</span><span class="p">;</span>
  <span class="nl">box-sizing</span><span class="p">:</span> <span class="n">border-box</span><span class="p">;</span>
<span class="p">}</span>

<span class="o">*,</span> <span class="o">*</span><span class="nd">:before</span><span class="o">,</span> <span class="o">*</span><span class="nd">:after</span> <span class="p">{</span>
  <span class="nl">box-sizing</span><span class="p">:</span> <span class="nb">inherit</span><span class="p">;</span>
<span class="p">}</span>

<span class="nf">#tweet-form</span> <span class="p">{</span>
  <span class="nl">padding</span><span class="p">:</span> <span class="m">10px</span> <span class="m">12px</span> <span class="m">10px</span> <span class="m">12px</span><span class="p">;</span>
  <span class="nl">background-color</span><span class="p">:</span> <span class="m">#e8f4fb</span><span class="p">;</span>
<span class="p">}</span>

<span class="nf">#tweet-form-handle</span> <span class="p">{</span>
  <span class="nl">font-size</span><span class="p">:</span> <span class="m">14px</span><span class="p">;</span>
  <span class="nl">margin-bottom</span><span class="p">:</span> <span class="m">8px</span><span class="p">;</span>
  <span class="nl">padding</span><span class="p">:</span> <span class="m">8px</span> <span class="m">10px</span> <span class="m">8px</span> <span class="m">10px</span><span class="p">;</span>
  <span class="nl">border</span><span class="p">:</span> <span class="m">1px</span> <span class="nb">solid</span> <span class="m">#a3d4f2</span><span class="p">;</span>
  <span class="nl">border-radius</span><span class="p">:</span> <span class="m">3px</span><span class="p">;</span>
  <span class="nl">width</span><span class="p">:</span> <span class="m">100%</span><span class="p">;</span>
<span class="p">}</span>

<span class="nf">#tweet-form-body</span> <span class="p">{</span>
  <span class="nl">font-size</span><span class="p">:</span> <span class="m">14px</span><span class="p">;</span>
  <span class="nl">margin-bottom</span><span class="p">:</span> <span class="m">8px</span><span class="p">;</span>
  <span class="nl">padding</span><span class="p">:</span> <span class="m">8px</span> <span class="m">10px</span> <span class="m">8px</span> <span class="m">10px</span><span class="p">;</span>
  <span class="nl">border</span><span class="p">:</span> <span class="m">1px</span> <span class="nb">solid</span> <span class="m">#a3d4f2</span><span class="p">;</span>
  <span class="nl">border-radius</span><span class="p">:</span> <span class="m">3px</span><span class="p">;</span>
  <span class="nl">width</span><span class="p">:</span> <span class="m">100%</span><span class="p">;</span>
<span class="p">}</span>

<span class="nf">#tweet-form-button</span> <span class="p">{</span>
  <span class="nl">color</span><span class="p">:</span> <span class="m">#ffffff</span><span class="p">;</span>
  <span class="nl">font-size</span><span class="p">:</span> <span class="m">14px</span><span class="p">;</span>
  <span class="nl">padding</span><span class="p">:</span> <span class="m">7px</span> <span class="m">8px</span><span class="p">;</span>
  <span class="nl">background-color</span><span class="p">:</span> <span class="m">#1b95e0</span><span class="p">;</span>
  <span class="nl">border</span><span class="p">:</span> <span class="m">1px</span> <span class="nb">solid</span> <span class="nb">transparent</span><span class="p">;</span>
  <span class="nl">border-radius</span><span class="p">:</span> <span class="m">4px</span><span class="p">;</span>
  <span class="nl">cursor</span><span class="p">:</span> <span class="nb">pointer</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.tweet</span> <span class="p">{</span>
  <span class="nl">padding</span><span class="p">:</span> <span class="m">10px</span> <span class="m">12px</span><span class="p">;</span>
  <span class="nl">border-top</span><span class="p">:</span> <span class="m">1px</span> <span class="nb">solid</span> <span class="m">#e1e8ed</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.light-grey</span> <span class="p">{</span>
  <span class="nl">color</span><span class="p">:</span> <span class="m">#8899a6</span><span class="p">;</span>
<span class="p">}</span>

<span class="nf">#tweet-form-delete-button</span> <span class="p">{</span>
  <span class="nl">color</span><span class="p">:</span> <span class="m">#ffffff</span><span class="p">;</span>
  <span class="nl">font-size</span><span class="p">:</span> <span class="m">14px</span><span class="p">;</span>
  <span class="nl">padding</span><span class="p">:</span> <span class="m">7px</span> <span class="m">8px</span><span class="p">;</span>
  <span class="nl">background-color</span><span class="p">:</span> <span class="m">#e53334</span><span class="p">;</span>
  <span class="nl">border</span><span class="p">:</span> <span class="m">1px</span> <span class="nb">solid</span> <span class="nb">transparent</span><span class="p">;</span>
  <span class="nl">border-radius</span><span class="p">:</span> <span class="m">4px</span><span class="p">;</span>
  <span class="nl">cursor</span><span class="p">:</span> <span class="nb">pointer</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>
:ET